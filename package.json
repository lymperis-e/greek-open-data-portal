{
  "private": true,
  "workspaces": {
    "packages": [
      "packages/terriajs",
      "packages/cesium",
      "packages/terriajs-server"
    ],
    "nohoist": [
      "**/husky"
    ]
  },
  "name": "terriajs-map",
  "version": "0.0.1",
  "description": "Geospatial catalog explorer based on TerriaJS.",
  "license": "Apache-2.0",
  "engines": {
    "node": ">= 12.0.0"
  },
  "repository": {
    "type": "git",
    "url": "http://github.com/TerriaJS/TerriaMap"
  },
  "dependencies": {
    "pm2": "^3.2.2",
    "terriajs-server": "^3.3.4",
    "vite": "^4.5.0"
  },
  "config": {
    "awsProfile": "terria",
    "awsS3PackagesPath": "s3://terria-apps/map",
    "awsRegion": "ap-southeast-2",
    "awsEc2InstanceType": "t2.small",
    "awsEc2ImageId": "ami-0065540df76a93885",
    "awsKeyName": "terria-kring",
    "awsS3ServerConfigOverridePath": "s3://terria-apps/map/privateserverconfig-2016-08-31.json",
    "awsS3ClientConfigOverridePath": "s3://terria-apps/map/privateclientconfig-2018-11-19.json",
    "docker": {
      "name": "data61/terria-terriamap",
      "include": "wwwroot node_modules devserverconfig.json index.js package.json version.js"
    }
  },
  "resolutions": {
    "@types/react": "^17.0.3"
  },
  "scripts": {
    "start": "node ./node_modules/terriajs-server/terriajs-server.js --config-file productionserverconfig.json",
    "start-pm2": "pm2 start ecosystem.config.js --update-env -- --config-file devserverconfig.json",
    "docker-build-local": "node ./deploy/docker/create-docker-context-for-node-components.js --build --push --tag auto --local",
    "docker-build-prod": "node ./deploy/docker/create-docker-context-for-node-components.js --build --push --tag auto",
    "docker-build-ci": "node ./deploy/docker/create-docker-context-for-node-components.js --build",
    "stop": "pm2 stop ecosystem.config.js",
    "pm2": "pm2",
    "gulp": "gulp",
    "gulp:watch": "gulp watch",
    "postinstall": "echo 'Installation successful. What to do next:\\n  yarn start       # Starts the server on port 3001\\n  gulp watch      # Builds TerriaMap and dependencies, and rebuilds if files change.'",
    "hot": "webpack-dev-server --inline --config buildprocess/webpack.config.hot.js --hot --host 0.0.0.0",
    "deploy": "aws --profile $npm_package_config_awsProfile s3 ls && rm -rf node_modules && yarn install --frozen-lockfile && yarn deploy-without-reinstall",
    "deploy-without-reinstall": "gulp clean && gulp release && yarn deploy-current",
    "deploy-current": "yarn get-deploy-overrides && gulp make-package --serverConfigOverride ./privateserverconfig.json --clientConfigOverride ./wwwroot/privateconfig.json && cd deploy/aws && ./stack create && cd ../..",
    "get-deploy-overrides": "aws s3 --profile $npm_package_config_awsProfile cp $npm_package_config_awsS3ServerConfigOverridePath ./privateserverconfig.json && aws s3 --profile $npm_package_config_awsProfile cp $npm_package_config_awsS3ClientConfigOverridePath ./wwwroot/privateconfig.json",
    "prettier": "prettier --write \"**/*\"",
    "pretty-quick": "pretty-quick",
    "prettier-check": "prettier --check \"**/*\""
  },
  "husky": {
    "hooks": {
      "pre-commit": "pretty-quick --staged"
    }
  }
}
